\documentclass[main.tex]{subfiles}
\begin{document}

\subsection{Nonrelativistic fluid mechanics} \label{sec:nonrelativisti-fluid-mechanics}

Nonrelativistic (compressible) fluid mechanics are described by the equations:
\begin{subequations}
\begin{align}
    \partial_t \rho_0 + \partial_i (\rho_0 v^i) &= 0 &\text{conservation of mass} \label{eq:classical-conservation-mass}\\
    \rho_0 \qty(\partial_t v^i + v^j \partial_j v^i) &= \partial_j \sigma^{ij} &\text{conservation of momentum}  \label{eq:classical-conservation-momentum}\\
    \rho_0 \partial_t E + v^i \partial_i E &= \partial_i \qty(\sigma^{ij}v_j + \kappa\partial^i T) &\text{conservation of energy} \label{eq:classical-conservation-energy}
\end{align}
\end{subequations}
where $\rho_0$ is the density of the fluid,
$v^i$ are the components of the velocity vector field,
$\sigma^{ij}$ is the classical stress tensor (or, equivalently, the \emph{negative} of the  space-like components of the stress-energy tensor \(T^{ij}\) ),
$E$ is the energy density of the fluid,
$\kappa$ is the thermal conductivity,
$T$ is the temperature  field of the fluid.

We use the compressible formulation in order for these to be closer to their relativistic counterpart, for which compressive effects cannot be ignored.

The nonrelativistic stress tensor can be written as:

\begin{equation}
    \sigma_{ij} = -(p - \xi \partial_k v^k ) \delta_{ij} + 2 \eta \partial_{(i} v_{j)}
\end{equation}
where $p$ is the (isotropic) pressure, $\eta$ the viscosity, $\xi$ is the bulk viscosity.\footnote{For consistency with the later sections, here we define \(\xi\) with the opposite sign to what appears in \cite[page 301]{Taub:1978}.} We are assuming that the normal stresses are only those exerted by pressure, so the diagonal terms $\sigma_{ii}$ (not summed) must just be $-p$. So, the term $-\xi \partial_k v^k$ must equal $\eta \partial_{(i} v_{i)} = 2\eta \partial_i v_i$ (not summed). Therefore, by isotropy, $\xi = -2\eta/3$.

Note that we are working in Euclidean 3D space, so the metric is the identity and upper and lower indices are equivalent.

The energy density is a sum of kinetic and specific energies:

\begin{equation}
    E = v^i v_i /2 + \varepsilon
\end{equation}
where $\varepsilon$ is the specific internal energy per unit mass.

\subsection{The relativistic fluid}

% The relativistic fluid: the assumptions we make, the quantities we use to describe it, the energy-momentum tensor and the equations of motion

% \subsection{Fluid mechanics}

We want to develop a formalism to treat a fluid dynamical problem in the presence of relativistic speeds and strong gravitational fields, such as in spherical accretion onto a black hole. It will have to be fully relativistic: the conservation laws will have to be written as tensorial equations.

We treat the fluid as a continuous medium which will have a certain density of particles per unit volume $n$: that is, what we consider ``infinitesimal'' is not actually arbitrarily small but should be considered much smaller than the characteristic lengths of the problem, while still containing many particles.

The 4-current of particles is $N^\mu = n u^\mu$, where \(u^\mu\) is the 4-velocity field of the fluid.
If these particles have a certain rest mass $m_0$, we can then define the rest-mass-flow vector $\rho_0 u^\mu = m_0 N^\mu$, which is conserved: $\nabla_\mu(\rho_0 u^\mu) = 0$, since particles do not spontaneously appear or disappear nor change their rest mass.
The presence of particles with different rest masses can be easily accounted for by adding the mass flow vectors.

Particles in a fluid can have three kinds of energy we concern ourselves with: mass, kinetic energy and other forms of energy (thermal, chemical, nuclear\dots).
We can always perform a change of coordinates to bring us to a frame in which the kinetic energy is zero.

Do note that, since our volume element is not actually arbitrarily small, being in the LRF only means that, locally, the average velocity of the fluid is purely timelike: the temperature can be nonzero, so in the LRF the particles in the volume element will still have isotropically distributed nonzero velocities.

We write the sum of mass-energy and internal energy as $\rho = \rho_0 (1+\epsilon)$, the \emph{energy} density of the fluid in its Local Rest Frame, while \(\rho_0\) is the \emph{mass} density in the LRF.
So, $\epsilon$ is the ratio of the internal non-mass energy to the mass.

\paragraph{Stress-energy tensor} \label{par:stress-energy-tensor}

The stress-energy tensor \(T^{\mu\nu}\) is a symmetric \((2,0)\) tensor whose \(\mu, \nu\) component is defined as the flux of \(\mu\)-th component of the four-momentum \(p^\mu\) through a surface of constant coordinate \(x^\nu\).

Because of our choice of the metric signature, the spatial part of the tensor corresponds to the \emph{negative} of the classical continuum-mechanics stress tensor: \(T^{ij} = - \sigma^{ij}\), since that tensor describes the stresses \emph{on} the ``box'' of fluid \cite[]{Moretti:2016}.

To give an example: for a gas of non-interacting particles, the stress-energy tensor is very simple: the momentum density is \(\rho u^\mu\), and then to obtain the flow through a surface of constant \(x^\nu\) we just need to multiply by \(u^\nu\), so in the Local Rest Frame we have:

\begin{equation}
    T^{\mu\nu} = \rho u^\mu u^\nu = \begin{bmatrix}
    \rho    & 0  &  0 & 0 \\
      0 & 0  & 0  & 0 \\
      0 & 0  & 0  & 0 \\
      0 & 0  & 0  & 0
    \end{bmatrix}\,.
\end{equation}

The fact that momentum is conserved (which follows from Noether's theorem applied to the translational invariance of spacetime) can be expressed as the statement that the stress-energy tensor is conserved: \(\nabla_\mu T^{\mu\nu} = 0\).

In our example, this can be written as

\begin{equation}
  \rho (a^\nu + u^\nu (\nabla_\mu u^\mu)) + u^\nu \dv{\rho}{\tau} = 0\,.
\end{equation}

\paragraph{Relativistic non-ideal fluid dynamics}

The evolution of the fluid is described by the conservation of the stress-energy tensor \(\nabla_\mu T ^{\mu \nu} =0\) and the conservation of mass \(\nabla_\mu (\rho_0 u^\mu) =0\).

If we wanted to analyze our fluids without \emph{any} approximation we would need to consider the stress-energy tensor of the fluid when solving the Einstein Field Equations: this can be done but it makes the geometry of the system significantly harder to work with, and since we wish to consider other effects such as heat transfer and viscosity throughout the fluid we assume the fluid is not self-gravitating, that is, we solve the conservation equations in a fixed Schwarzschild metric background.
This assumption is reasonable in our case: the components of the stress-energy tensor of the infalling gas are much smaller than those of the black hole.

Any stress-energy tensor can be decomposed into its space and time-like parts in the local rest frame of the fluid:

\begin{equation} \label{eq:stress-energy-tensor-decomposition}
    T_{\mu \nu} = w u_\mu u_\nu + w_\mu u_\nu + u_\mu w_\nu + w _{\mu \nu}
\end{equation}
where \cite[eqs. 8.2, 8.3, 8.5]{Taub:1948}:
\begin{subequations} \label{eq:components-stress-energy-tensor}
\begin{align}
  w &=  T _{\mu \nu} u^\mu u^\nu = \rho_0 (1 + \varepsilon) = \rho & \text{rest energy} \\
  w_\mu &= T _{\nu \sigma} h^\sigma _\mu u^\nu  = -\kappa h_\mu ^\sigma  \qty(\partial_\sigma T + T a_\sigma) & \text{heat conduction} \\
  w_{\mu \nu} &= T_{\rho \sigma} h^\rho _\mu h^\sigma_\nu = \qty(p - \xi \theta) h_{\mu \nu} - 2 \eta \sigma_{\mu \nu}  & \text{pressure and viscous stresses.}
\end{align}
\end{subequations}

Do note that by definition the tensors \(w^\mu\) and \(w^{\mu\nu}\) are purely spatial: \(u^\mu w_\mu = u^\mu w_{\mu \nu} = 0\).

For the definition of the acceleration, vorticity etc. see equation \eqref{eq:covariant-acceleration-decomposition}.

As in section \nameref{sec:nonrelativisti-fluid-mechanics} \(\eta\) is the viscosity, \(\xi\) is the bulk viscosity,  \(\kappa\) is the thermal conductivity, \(T\) is the temperature field, \(p\) is the pressure field, \(\rho_0\) is the rest mass density while \(\rho = \rho_0 (1 + \varepsilon)\) is the rest energy density.

\begin{greenbox}
    The fact that the decomposition can be written in this way is not proven in \cite[]{Taub:1978}, but it seems like a proof can be found in \cite[]{Eckart:1940}, which is locked behind a paywall.
\end{greenbox}

Equivalently, we can write
\begin{subequations} \label{eq:stress-energy-tensor-decomposition-2}
\begin{align}
  T_{\mu\nu} &= T_{\mu\nu}^p && - T_{\mu\nu}^V &&+ T_{\mu\nu}^h  \\
  &= w u_\mu u_\nu + p h_{\mu\nu} &&-\xi \theta h_{\mu\nu} - 2 \eta \sigma_{\mu\nu} &&+2w_{(\mu} u_{\nu)}  \\
  &\text{perfect fluid} && \text{viscous stresses} && \text{heat conduction.} \nonumber
\end{align}
\end{subequations}

In the nonrelativistic limit the velocity is approximately \(u^\mu = (1, v^i)\), so the conservation of mass becomes \eqref{eq:classical-conservation-mass}, while we can obtain both
the conservation of energy \eqref{eq:classical-conservation-energy}
and the conservation of momentum \eqref{eq:classical-conservation-momentum}
from the four equations of conservation of the stress-energy tensor.

\paragraph{Viscous and heat-flow relativistic forces}

If we consider the spatial components of the conservation equations by applying \(h^\sigma_\mu \nabla_\nu\) to the formulation of the stress-energy tensor given in \eqref{eq:stress-energy-tensor-decomposition-2} we get:

\begin{subequations}
\begin{align}
  h^\sigma_\mu \nabla_\nu \qty((p+\rho) u^\mu u^\nu + p g^{\mu\nu}) &=
  h^\sigma_\mu \nabla_\nu \qty(T^{\mu\nu}_V - T^{\mu\nu}_h)  \\
  (\rho + p) a^\sigma + h^\sigma_\nu \partial^\nu p &= h^\sigma_\mu \nabla_\nu \qty(
  +\xi \theta h^{\mu\nu} + 2 \eta \sigma^{\mu\nu} - 2w^{(\mu} u^{\nu)})  \\
  &= \underbrace{\nabla_\nu T^{\sigma\nu}_V - u^\sigma \qty(\frac{\xi \theta^2}{3} +2 \eta \sigma_{\mu\nu} \sigma^{\mu\nu})}_{\substack{\mathscr F ^\sigma _V}}
  \underbrace{ - \nabla_\nu (w^\sigma u^\nu) - w^\nu \nabla_\nu u^\sigma + a_\mu w^\mu u^\sigma  }_{\substack{\mathscr F ^\sigma _h}} \,.
  \label{eq:full-spatial-equations-of-motion}
\end{align}
\end{subequations}

% \begin{greenbox}
%   Shouldn't there be an \(\eta\) in front of \(\sigma^2\)? Is it a typo in \cite[]{Taub:1978}?
%   The heat part does not seem to make sense, I'm missing how \(-w^\mu u^\nu \nabla_\nu u_\mu = u_\mu (u^\nu \nabla_\nu w^\mu + w^\nu \nabla_\nu u^\mu)\): my results are
%
%   \begin{subequations}
%   \begin{align}
%     h^\sigma _\mu \nabla_\nu \qty(2 w^{(\mu} u^{\nu)}) &=  (\delta_\mu ^\sigma + u^\sigma u_\mu) \nabla_\nu \qty(w^\mu u^\nu + u^\mu w^\nu)  \\
%     &= \nabla_\nu \qty(w^\sigma u^\nu) + \nabla_\nu (u^\sigma w^\nu)
%     + u^\sigma u_\mu \nabla_\nu \qty(w^\mu u^\nu + u^\mu w^\nu)  \\
%     &= \nabla_\nu \qty(w^\sigma u^\nu) + \nabla_\nu (u^\sigma w^\nu)
%     + u^\sigma u_\mu \qty(\cancelto{0}{ w^\mu \nabla_\nu u^\nu } + u^\nu \nabla_\nu w^\mu + w^\nu \nabla_\nu u^\mu + u^\mu \nabla_\nu w^\nu)  \\
%     &= \nabla_\nu \qty(w^\sigma u^\nu) + \nabla_\nu (u^\sigma w^\nu)
%     + u^\sigma u_\mu \qty(u^\nu \nabla_\nu w^\mu + w^\nu \nabla_\nu u^\mu) - u^\sigma \nabla_\nu w^\nu  \\
%     &= \nabla_\nu \qty(w^\sigma u^\nu) + w^\nu \nabla_\nu u^\sigma
%     + u^\sigma u_\mu \qty(u^\nu \nabla_\nu w^\mu + w^\nu \nabla_\nu u^\mu) \\
%     &\overset{?}{=} \nabla_\nu \qty(w^\sigma u^\nu) + w^\nu \nabla_\nu u^\sigma
%     - u^\sigma w_\mu a^\mu
%   \end{align}
%   \end{subequations}
%
%   so the first two terms are there, the rest does not look right.
% \end{greenbox}

The vectors \(\mathscr F^\sigma _{h, V}\) are relativistic forces on the fluid due respectively to heat flow and viscosity.

In the perfect fluid case the RHS is zero we simply get Euler's equation from \eqref{eq:full-spatial-equations-of-motion}.

\paragraph{The Second Principle in GR}


Because of the conservation of the stress-energy tensor, we have:

\begin{equation} \label{eq:velocity-stress-energy-tensor-identity}
    \nabla_\nu \qty(u_\mu T ^{\mu \nu}) = T^{\mu \nu} \nabla_\nu u_\mu \,.
\end{equation}

Let us also consider the \emph{fundamental thermodynamic relation}, which follows from the first and second principles in classical thermodynamics, as a definition for the scalar entropy per unit rest mass \(S\):

\begin{equation} \label{eq:differential-entropy}
    T\dd{S} = \dd{\varepsilon} + p \dd{\frac{1}{\rho_0}} \,.
\end{equation}

\begin{claim}
    We can mold equation \eqref{eq:velocity-stress-energy-tensor-identity} into a version of the second principle of thermodynamics

    \begin{equation} \label{eq:second-principle-thermodynamics}
        T \nabla_\mu S^\mu = \xi \theta^2 + 2 \eta \sigma_{\mu\nu} \sigma^{\mu\nu} + \frac{w^\mu w_\mu}{\kappa T} \geq 0
    \end{equation}
    where we define \(S^\mu = \rho_0 S u^\mu + w^\mu /T\).
\end{claim}

\begin{proof}
    We will need the decompositions of
    the derivative of velocity \eqref{eq:covariant-acceleration-decomposition},
    of the stress-energy tensor \eqref{eq:stress-energy-tensor-decomposition}, \eqref{eq:components-stress-energy-tensor},
    the expression of differential entropy \eqref{eq:differential-entropy}
    and the conservation of mass \(\nabla_\mu (\rho_0 u^\mu) = 0\).

    First of all, the LHS of \eqref{eq:velocity-stress-energy-tensor-identity} can be greatly simplified by noticing that \(u^\mu w_\mu = u^\mu w_{\mu \nu} = 0\), so it becomes %\footnote{One may think to expand \(\nabla_\nu w^\nu\) and I had, bringing along many useless terms, when actually it can be kept this way and will just cancel later on.}

    \vspace{-1cm}

    \begin{subequations}
    \begin{align}
        \nabla_\nu \qty(u_\mu T ^{\mu \nu}) &= \nabla_\nu \left( w \underbrace{u_\mu u^\mu}_{-1} u^\nu + \underbrace{u_\mu w^\mu}_{0} u^\nu + \underbrace{ u_\mu u^\mu}_{-1} w^\nu + \underbrace{u_\mu w ^{\mu \nu}}_{0}\right) \\
         &= \nabla_\nu \qty(- u^\nu \rho_0 (1 + \varepsilon) - w^\nu) \\
         &=  - \rho_0 u^\nu \partial_\nu \varepsilon - \nabla_\nu w^\nu\,.
    \end{align}
    \end{subequations}

    In the RHS of \eqref{eq:velocity-stress-energy-tensor-identity} many terms are cancelled as well because they contain contractions of space and timelike indices: we get

    \begin{subequations}
    \begin{align}
      \qty(\nabla_\nu u_\mu) T^{\mu \nu} &=
      \qty(\omega_{\nu \mu} + \sigma_{\nu\mu} + \frac{1}{3} \theta h_{\nu\mu}
      -  a_\mu u_\nu) \qty(w u^\mu u^\nu + w^\mu u^\nu + u^\mu w^\nu + w ^{\mu \nu})  \\
      &= w^{\mu\nu} \qty(\omega_{\mu\nu} + \sigma_{\mu\nu} + \frac{\theta h_{\mu\nu}}{3}) + a_\mu w^\mu  \\
      &= \qty(\qty(p - \xi \theta) h^{\mu \nu} - 2 \eta \sigma^{\mu \nu})
      \qty(\omega_{\mu\nu} + \sigma_{\mu\nu} + \frac{\theta h_{\mu\nu}}{3})
      + a_\mu \qty(-\kappa h^\mu _\sigma  \qty(\partial^\sigma T + T a^\sigma))  \\
      &= \qty(p - \xi \theta) \theta - 2 \eta \sigma_{\mu\nu} \sigma^{\mu\nu}
      - \kappa a_\mu \partial^\mu T - \kappa T a_\mu a^\mu \,.
    \end{align}
    \end{subequations}

    So far, we have:

    \begin{equation} \label{eq:step1-second-principle-proof}
        - \rho_0 u^\nu \partial_\nu \varepsilon
        - \nabla_\nu w^\nu
        = \qty(p - \xi \theta) \theta - 2 \eta \sigma_{\mu\nu} \sigma^{\mu\nu}
        - \kappa a_\mu \partial^\mu T - \kappa T a_\mu a^\mu \,.
    \end{equation}

    Let us rearrange \eqref{eq:step1-second-principle-proof} in a convenient way:

    \begin{equation} \label{eq:step2-second-principle-proof}
        + \rho_0 u^\nu \partial_\nu \varepsilon + p \theta =
        % - \kappa \qty(
        % \qty(\nabla^\nu + 3 a^\nu + \theta u^\nu + u^\alpha u^\nu \nabla_\alpha
        % ) \partial_\nu T + T (\nabla_\nu + a_\nu) a^\nu
        % )
        - \nabla_\nu w^\nu
        + \xi \theta^2 + 2 \eta \sigma_{\mu\nu} \sigma^{\mu\nu}
        + \kappa a_\mu \partial^\mu T + \kappa T a_\mu a^\mu \,.
    \end{equation}

    Now let us consider a quantity we wish to obtain from these manipulations:
    \(T \nabla_\mu S^\mu\). It can be expanded using the continuity equation into:

    \begin{equation} \label{eq:entropy-vector-identity}
        T \nabla_\mu S^\mu
        = T \nabla_\mu \qty(\rho_0 S u^\mu + \frac 1T w^\mu )
        = T \rho_0 u^\mu \partial_\mu S + \nabla_\mu w^\mu - w^\mu \frac{\nabla_\mu T}{T} \,.
    \end{equation}

    We can turn the differentials in \eqref{eq:differential-entropy} into proper-time derivatives: \(\dd \rightarrow \dv*{}{\tau} = u^\mu \partial_\mu \). Also, we can use the continuity equation to see that \(u^\mu \partial_\mu \rho_0 = - \rho_0 \theta\).
    Then \eqref{eq:differential-entropy} becomes:

    \begin{equation} \label{eq:differential-entropy-explicit}
        T \dv{S}{\tau}  = \dv{\varepsilon}{\tau} - \frac{p}{\rho_0^2} \dv{\rho_0}{\tau}  =\dv{\varepsilon}{\tau} + \frac{p \theta}{\rho_0} \,.
    \end{equation}

    So we can write the LHS of \eqref{eq:step2-second-principle-proof}, using the identities in
    equation \eqref{eq:entropy-vector-identity} and \eqref{eq:differential-entropy-explicit}:

    \begin{equation} \label{eq:step3-second-principle-proof}
        \rho_0 \qty(u^\nu \partial_\nu \varepsilon + \frac{p \theta}{\rho_0})
        = \rho_0 T u^\nu \partial_\nu S
        = T\nabla_\mu S^\mu - \nabla_\mu w^\mu + \frac{1}{T} w^\mu \nabla_\mu T\,.
    \end{equation}

    Let us substitute \eqref{eq:step3-second-principle-proof} into \eqref{eq:step2-second-principle-proof},
    and then subtract the desired result \eqref{eq:second-principle-thermodynamics}  from the equation: this way, if we get an identity the proof will be complete (this may seem circular, but it is done just for convenience in the algebraic manipulations: to get a more rigorous argument one may just reverse the steps, using the identity \eqref{eq:step-second-principle-proof-after-subtraction} in equation \eqref{eq:step-second-principle-proof-before-subtraction} to get equation \eqref{eq:second-principle-thermodynamics}).
    \begin{subequations}
    \begin{align}
      T\nabla_\mu S^\mu - \nabla_\mu w^\mu + \frac{1}{T} w^\mu \nabla_\mu T &=
      - \nabla_\nu w^\nu
      + \xi \theta^2 + 2 \eta \sigma_{\mu\nu} \sigma^{\mu\nu}
      + \kappa a_\mu \partial^\mu T + \kappa T a_\mu a^\mu
      \label{eq:step-second-principle-proof-before-subtraction} \\
      - \nabla_\mu w^\mu + \frac{1}{T} w^\mu \nabla_\mu T &=
      - \nabla_\nu w^\nu
      + \kappa a_\mu \partial^\mu T + \kappa T a_\mu a^\mu
      - \frac{w^\mu w_\mu}{\kappa T} \label{eq:step-second-principle-proof-after-subtraction} \\
      + \frac{1}{T} w^\mu \nabla_\mu T &=
      + \kappa a_\mu \partial^\mu T + \kappa T a_\mu a^\mu
      - \frac{w^\mu w_\mu}{\kappa T} \,. \label{eq:step4-second-principle-proof}
    \end{align}
    \end{subequations}

    The last term in \eqref{eq:step4-second-principle-proof} looks like:
    \begin{equation} \label{eq:step5-second-principle-proof}
        \frac{w^\mu w_\mu}{\kappa T} = \frac{1}{\kappa T }
        \kappa^2 h^\sigma _\mu h^{\mu\nu} \qty(\partial_\sigma T + T a_\sigma) \qty(\partial_\nu T + T a_\nu)
        = \kappa \qty(\frac{h^{\mu\nu}}{T} \partial_\mu T \partial_\nu T + 2 a^\mu \partial_\mu T + T a_\mu a^\mu) \,.
    \end{equation}

    Inserting the identity in \eqref{eq:step5-second-principle-proof}  and making the last \(w^\mu\) explicit in \eqref{eq:step4-second-principle-proof} we get:
    \begin{subequations}
    \begin{align}
      -\frac{1}{T} \kappa h^\mu _\sigma  \qty(\partial^\sigma T + T a^\sigma) \partial_\mu T  &= + \kappa a_\mu \partial^\mu T + \kappa T a_\mu a^\mu
      -\kappa \qty(\frac{h^{\mu\nu}}{T} \partial_\mu T \partial_\nu T + 2 a^\mu \partial_\mu T + T a_\mu a^\mu) \\
      +\frac{1}{T} h^{\mu\nu} \partial_\nu T  \partial_\mu T + h^{\mu\nu} a_\nu \partial_\mu T  &= - a_\mu \partial^\mu T -  T a_\mu a^\mu
      + \qty(\frac{h^{\mu\nu}}{T} \partial_\mu T \partial_\nu T + 2 a^\mu \partial_\mu T + T a_\mu a^\mu) \\
      0  &= - a_\mu \partial^\mu T -  T a_\mu a^\mu
      + \qty( a^\mu \partial_\mu T + T a_\mu a^\mu)
    \end{align}
    \end{subequations}

    Thus we have proved the equation in \eqref{eq:second-principle-thermodynamics}, the inequality follows directly from the fact that we are considering square moduli of spacelike vectors, and the coefficients such as \(\xi\) are assumed to be positive.
\end{proof}

If we assume that the fluid is in equilibrium (\(\nabla_\mu S^\mu = 0\)) then we must have \(\theta = 0\) (no compression), \(\sigma_{\mu\nu} = 0 \) (no shear stresses), \(w_\mu=0\): the interpretation of this last equation is slightly harder, but it is equivalent to the statement that, in the LRF, the log-temperature gradient is purely spatial and it defines the acceleration, by \(a_\sigma = - \partial_\sigma \log T\).

% \subsection{Ideal fluids}
%
% in equilibrium

%The Eckart approach to almost-equilibrium fluids (not a full derivation: just the key points and the results)

\paragraph{Ideal fluids}

They are fluids with \(\eta=\xi=\kappa=0\), that is, without viscosity (neither compressive nor shear) nor heat transmission.
They are described by the following stress-energy tensor:

\begin{equation}
    T^{\mu\nu} = \rho u^\mu u^\nu + p h^{\mu\nu} = \rho_0 h u^{\mu} u^\nu + p g^{\mu\nu}
\end{equation}
where \(h = (p + \rho) / \rho_0\) is the specific enthalpy.
If our fluid is ideal then the RHS of \eqref{eq:second-principle-thermodynamics} is zero and so is \(w^\mu\),
therefore \(T \nabla_\mu S^\mu = T \nabla_\mu \qty(\rho_0 S u^\mu) = T \rho_0 u^\mu \partial_\mu S\) by the continuity equation.
So, \(S\) is conserved along the world-lines of the fluid.

Also, the RHS of \eqref{eq:full-spatial-equations-of-motion} is zero, therefore we get the Euler equation:

\begin{equation} \label{eq:relativistic-euler}
    (p+\rho) a^\mu + h^{\mu \nu} \partial_\nu p =0 \,.
\end{equation}

\paragraph{Speed of sound}

Following \cite[]{Yoshida:2011}.

The definition of the adiabatic speed of sound is \(v_s^2 = (\pdv*{p}{\rho})_s\): here we give a justification for it.

We work in Minkowski spacetime, where \(g_{\mu\nu} = \eta_{\mu\nu}\), and with an ideal fluid, for which \(T_{\mu\nu} = (p+ \rho) u_\mu u_\nu + p \eta_{\mu\nu}\). Then, the equations of conservation of mass and momentum read:

\begin{subequations}
\begin{align}
  \rho_0 \partial_\mu u^\mu + u^\mu \partial_\mu \rho_0 &= 0 & \text{mass}  \\
  u^\mu \qty(\partial_\mu \rho - h \partial_\mu \rho_0) &=0 & \text{momentum along } u^\mu  \\
  (p+\rho) a^\mu + h^{\mu \rho} \partial_\rho p &=0 & \text{momentum in the span of } h_{\mu\nu}
\end{align}
\end{subequations}

where \(h\) is the specific enthalpy. If we assume small perturbations \(p \rightarrow p + \delta p\), \(\rho_0 \rightarrow \rho_0 + \delta \rho_0\), \(\rho \rightarrow \rho + \partial \rho\), \(u^\mu \rightarrow (1, \delta u^x, 0, 0)\)
(the normalization condition is satisfied to first order in \(\delta u^x\)) we get our three equations, up to first order in the perturbations:

\begin{subequations}
\begin{align}
  \partial_x (\delta u^x) &= -\frac{\partial_t (\delta \rho_0)}{\rho_0}  \\
  \partial_t (\delta \rho) - h \partial_t (\delta \rho_0) &= 0  \\
  -(p+ \rho) \partial_t (\delta u^x) &= \partial_x p \,.
\end{align}
\end{subequations}

We manipulate these by differentiating and substituting, in order to eliminate the dependence on \(\delta u^x\) and \(\rho_0\), and get:
\begin{subequations}
\begin{align}
  \partial_t \delta \rho + (p+\rho) \partial_x (\partial u^x) &= 0 \\
  \partial_x \delta p + (p+\rho) \partial_t (\partial u^x) &= 0
\end{align}
\end{subequations}
which simplifies to \(\partial_{tt}^2 \delta \rho - \partial_{xx}^2 \delta p = 0\).

We can write this as the wave equation \(\qty(v_s^{-2} \partial_{tt}^2 - \partial_{xx}^2 ) \delta p = 0\), where we to define \(v_s^2 = \pdv*{p}{\rho}\), the square of the characteristic velocity of propagation \(v_s\).

\subsection{Bondi accretion: the adiabatic case}

We now apply the formalism developed in this section to the problem of spherical accretion into a black hole the \emph{adiabatic} case, where we model the gas as an ideal fluid.

We assume the geometry of the spacetime is described by the Schwarzschild metric \eqref{eq:schwartzshild-line-element} and make the following assumptions:

\begin{enumerate}
  \item spherical symmetry: \(\partial_\theta = \partial_\varphi = 0\);
  \item stationarity: \(\partial_t = 0\).
\end{enumerate}

The comoving tetrad defined by the fluid's motion is called the \emph{fiducial congruence reference}.

\begin{claim}
When written with respect to the usual spherical coordinates \((t, r, \theta, \varphi)\) the fiducial congruence looks like:

\begin{subequations} \label{eq:fiducial-frame}
    \begin{align}
        \hat{t} = e_t &= u^\mu = \qty(\gamma^2 / y, -yv, 0,0)  \\
        \hat{r} = e_r &= a^\mu / \sqrt{a^\rho a_\rho} = \qty(-v \gamma^2 /y, y, 0, 0) \\
        \hat{\theta} =  e_\theta &= \qty(0,0, 1/r, 0)  \\
        \hat{\varphi} =  e_ \varphi &= \qty(0,0,0, 1/(r \sin(\theta)))
    \end{align}
\end{subequations}
where \(\gamma\) is the Lorentz factor ($\gamma = 1/\sqrt{1-v^2}$), and $y=\gamma \sqrt{1+2\Phi} = \gamma \sqrt{1 - 2M/r} $ is the ``energy-at-infinity per unit rest mass'' (see \cite[equation 3]{ThorneFLammmangZytkow:1981feb}).
\end{claim}

\begin{proof}
    First of all, we prove that we can form a comoving tetrad by rescaling the vectors \((u^\mu, a^\mu, e_\theta, e_\varphi)\). They are clearly orthogonal, let us show that they are Fermi-Walker transported (see equation \eqref{eq:fermi-walker-transport}); notice that the condition of being FW-transported is 1-homogeneous, so proving it before or after normalization makes no difference.
    For the velocity \(u^\mu \propto \hat{t}\)  we have

    \begin{equation}
        u^\nu \nabla_\nu u^\mu = a^\mu = u_\rho \qty(u^\mu a^\rho - u^\rho a^\mu) = - (u_\rho u^\rho) a^\mu \,.
    \end{equation}

    For the acceleration \(a^\mu \propto \hat{r} \) we need the following identity: \(0=\dv*{(u^\mu a_\mu)}{\tau} =a^\mu a_\mu + u^\mu \dv*{a_\mu}{\tau} \). We multiply this by \(u^\mu\) to get: \(u^\mu (a^\rho a_\rho) = \dv*{a^\mu}{\tau}\).

    Then, we can prove:

    \begin{equation}
      u^\nu \nabla_\nu a^\mu
      = a_\rho (u^\mu a^\rho)
      = a_\rho (u^\mu a^\rho - u^\rho a^\mu)\,.
    \end{equation}

    In the proof for the \(\hat{\theta} \) and \(\hat\varphi\) vectors, the RHS vanishes immediately since the time-radial surface to which the velocity and acceleration belong is orthogonal to the sphere's surface; the LHS instead vanishes since it is a derivative with respect to proper time, therefore along the fluid's flow lines, which all lie in the time-radial surface.

    Now, we need to show that the velocity and the acceleration actually have the form shown in \eqref{eq:fiducial-frame}: for the velocity, it is enough to impose the normalization \(u^\mu u_\mu = -1 \), and to consider an observer with velocity  \(k^\mu\) who is stationary with respect to the spherical coordinates: by normalization their 4-velocity will be \(k^\mu = (1/\sqrt{g_{00}}, 0,0,0)\), and the local transformation between the frames will be a Lorentz transformation with factor \(\gamma\) defined by the fluid's velocity, therefore it must hold that \(\gamma = - k^\mu u_\mu\).

    Since \(g_{00} = - y^2 / \gamma^2\) we have:

    \begin{equation}
      \gamma = - k^\mu u^\nu g_{\mu\nu} = - u^0 \frac{g_{00}}{\sqrt{-g_{00}} }
      = u^0 \sqrt{-g_{00}} = u^0 \frac{y}{\gamma}
    \end{equation}
    which gives us \(u^0 = \gamma^2 / y\), while for \(u^1\) we must impose (already knowing that \(u^2 = u^3 = 0\)):

    \begin{subequations}
    \begin{align}
      -1 &= (u^0)^2 g_{00} + (u^1)^2 g_{11} \\
      &= -\qty(\frac{\gamma^2}{y})^2 \qty(\frac{y}{\gamma} )^2 + (u^1)^2 \frac{\gamma^2}{y^2} \\
      -1 + \gamma^2 &= (u^1)^2 \frac{\gamma^2}{y^2} \\
      y^2 (-\frac{1}{\gamma^2}  + 1) &= (u^1)^2 \\
      y^2 v^2 &= (u^1)^2 \,.
    \end{align}
    \end{subequations}

    As for \(a^\mu\), we need not compute the covariant derivative since the two components of the normalized vector we want are determined by \(u^\mu a_\mu = 0= u^\mu \hat{r}^\nu g_{\mu\nu}\) and the normalization condition \(\hat{r} \cdot \hat{r} = 1\). The first one translates to \(\hat{r}^0 y^2 + \hat{r} ^1 v \gamma^2 = 0\) and the second one to \((\hat{r}^0)^2 (- y^2 / \gamma^2) + (\hat{r}^1)^2 (\gamma^2 / y^2) = 1\), since we know the other two components of the acceleration are zero.
    Solving this system for the two unknown components yields precisely the desired expression.

    The \(\hat{\theta}\) and \(\hat{\varphi}\) vectors just need to be rescaled, and they will need to become \(1 / \sqrt{g_{22}}\) and \(1/\sqrt{g_{33}}\) respectively.
\end{proof}

The conservation of mass holds: if $\rho_0$ is the rest mass density of the fluid, we must have $\nabla_\mu \qty(\rho_0 u^\mu) =0$. This, using the formula for covariant divergence \eqref{eq:covariant-divergence}, yields:

\begin{equation} \label{eq:integral-continuity}
    \dv{}{r} \qty(\rho_0 yvr^2) = 0 \,.
\end{equation}

For any function \(Q\),  \(\dv*{Q}{r} = 0\) is equivalent to \(\dv*{\log Q }{\log r} = 0 \), therefore we can recast \eqref{eq:integral-continuity} into

\begin{equation} \label{eq:differential-continuity}
  \dv{\log \rho_0}{\log r} +
  \dv{\log yv}{\log r} + 2 = 0 \,.
\end{equation}

In the newtonian limit both $\gamma$ and $y$ approach 1; also, the infalling mass rate $\Dot{M}$ at a certain radius is $\rho_0 (r) v(r) 4\pi r^2$. Then, by continuity to the newtonian limit, the quantity which is constant with respect to the radius must be $\Dot{M} / (4\pi)$: therefore

\begin{equation} \label{eq:mass-conservation-integral}
  \dot{M} = 4 \pi\rho_0 yvr^2 \,.
\end{equation}

We also have the Euler equation \eqref{eq:relativistic-euler}.

The only interesting component of this is the radial one, so we need to calculate \(a^1 = u^\mu \nabla_\mu u^1 = \dv*{u^1}{\tau} + \Gamma^1_{\mu \nu} u^\mu u^\nu \). To do this we will need the radial Schwarzschild Christoffel coefficients:

\begin{equation}
  \Gamma^1_{\mu \nu} = \left[\begin{matrix}\frac{M \left(- 2 M + r\right)}{r^{3}} & 0 & 0 & 0\\0 & \frac{M}{r \left(2 M - r\right)} & 0 & 0\\0 & 0 & 2 M - r & 0\\0 & 0 & 0 & \left(2 M - r\right) \sin^{2}{\left(\theta \right)}\end{matrix}\right]
\end{equation}
while the proper-time derivative is \(\dv*{}{\tau} = u^\mu \partial_\mu = yv\partial_1\).
Plugging in the expression for the only relevant component of \(h^{\mu\nu}\), \(h^{11} = g^{11} + u^1 u^1 = (1 + 2 \Phi) (1 + v^2 \gamma^2) = y^2\)
we get, after a lengthy computation,

\begin{equation}
  a^1 = y^2 \qty(\gamma^2 v \dv{v}{r} + \frac{M}{(1+ 2 \Phi) r^2}) \,.
\end{equation}

Substituting this into the (radial component of the) Euler equation \eqref{eq:relativistic-euler} we get

\begin{subequations}
\begin{align}
  (p + \rho) y^2 \qty(\gamma^2 v \dv{v}{r} + \frac{M}{(1+ 2 \Phi) r^2}) &= - h^{1 1} \partial_1 p = - y^2 \partial_1 p \\
   \gamma^2 v \dv{v}{r} + \frac{M}{(1+ 2 \Phi) r^2} + \frac{1}{p + \rho} \dv{p}{r} &= 0 \,.
  \label{eq:ideal-euler}
\end{align}
\end{subequations}

% \begin{greenbox}
%   In equations 3.12.7, 8 in \cite{Nobili:2000} there is most definitely a sign error: the term proportional to \(M/r^2\) should be positive.
% \end{greenbox}

Also, from the projection of the conservation of the ideal fluid stress energy tensor onto the 4-velocity,
\(-u_\mu \nabla_\nu T^{\mu\nu}= 0 \),
which can be written as
\(\dv*{\rho}{\tau} + (p + \rho) \theta = 0 \)
and the conservation of mass, which can be written as
\(\dv*{\rho_0}{\tau} + \rho_0 \theta = 0 \)
or
\(\theta = - \rho_0^{-1} \dv*{\rho_0}{\tau} \)
we get an equation for the variation of the total internal energy, which holds for ideal fluids at constant entropy:

\begin{equation} \label{eq:enthalpy-definition}
    \dv{\rho}{\tau} = \frac{p+\rho}{\rho_0} \dv{\rho_0}{\tau}
    \qquad
    \text{or}
    \qquad
    \qty(\pdv{\rho}{\rho_0})_s = \frac{p + \rho}{\rho_0} \defeq h
\end{equation}

where $h$ is the specific enthalpy.

\paragraph{The Bernoulli equation}

From these we can show that

\begin{claim}
  The quantity $\gamma h \sqrt{1+2\Phi} = yh$ , is a constant of motion.
\end{claim}

\begin{proof}
First of all, by direct computation it can be shown from the definition of \(y\) that

\begin{equation} \label{eq:log-y-conservation}
  \gamma^2 v \dv{v}{r} + \frac{M}{(1+ 2 \Phi) r^2} = \dv{\log y }{r} \,.
\end{equation}

Then, following \textcite[section 6.3]{Gourgoulhon:2006bn} we find that \(\dd{p} = \rho_0 \dd{h}\) in the isentropic case, therefore

\begin{equation} \label{eq:log-h-conservation}
  \frac{1}{\rho + p} \dv{p}{r}  =  \dv{\log h}{r}
\end{equation}
so we can substitute the results in \eqref{eq:log-y-conservation} and \eqref{eq:log-h-conservation} into \eqref{eq:ideal-euler}:

\begin{equation}
  \dv{\log h}{r} + \dv{\log y }{r} = \dv{\log (hy) }{r} = 0 \,.
\end{equation}
\end{proof}

In the nonrelativistic, weak-field limit this becomes the classical conservation of density of energy:
%
\begin{equation}
    \gamma h \sqrt{1+2\Phi} \approx \frac{p}{\rho_0} + \frac{v^2}{2} - \frac{M}{r} + \epsilon = \const \,.
\end{equation}

We can reframe the equations we found as the following system, in which we introduce the notation of primes denoting derivatives with respect to \(\log r \), which properly speaking would be ill-defined but we understand to mean \(\dv*{}{\log r} \defeq r \dv*{}{r} \):
%
\begin{subequations}
\begin{align}
  \frac{y'}{y} + \frac{p'}{p + \rho}  &= 0 & \text{Euler equation} \label{eq:accretion-euler}  \\
  \rho' - h \rho_0' &= 0  & \text{energy equation}  \label{eq:accretion-energy}\\
  \frac{(yv)'}{yv} + \frac{\rho_0'}{\rho_0} + 2 &=0 & \text{mass conservation.}  \label{eq:accretion-mass}
\end{align}
\end{subequations}

In order to reframe these we rewrite the gradients of \(\rho\) and \(P\) in terms of \(\rho_0\) and \(T\): the following equations are just a useful way to reframe the multivariate chain rule.
%
\begin{subequations}
\begin{align}
  \frac{\rho'}{p+ \rho}  &= A \frac{\rho_0'}{\rho_0}
      + B \frac{T'}{T} \\
  \frac{p'}{p+ \rho}  &= a \frac{\rho_0'}{\rho_0}
      + b \frac{T'}{T}
\end{align}
\end{subequations}
%
where the subscripts \(T\) and \(\rho_0\) on the derivatives mean that the denoted quantity should be held constant when differentiating; the parameters \(A\), \(B\), \(a\) and \(b\) are defined by:

\begin{subequations}
\begin{align}
  A &= \frac{\rho_0}{p + \rho} \qty(\pdv{\rho}{\rho_0})_T
  &B = \frac{T}{p + \rho} \qty(\pdv{\rho}{T})_{\rho_0} \\
  a &= \frac{\rho_0}{p + \rho} \qty(\pdv{p}{\rho_0})_T
  &b = \frac{T}{p + \rho} \qty(\pdv{p}{T})_{\rho_0}
\end{align}
\end{subequations}

These are related by the reciprocity relation \cite[eq. B3]{Flammang:1982}: \(A + b = 1\).

When inserting these relations into equation \eqref{eq:accretion-energy} we get:
%
\begin{subequations}
\begin{align}
  0 &= A \frac{\rho_0 '}{\rho_0} + B \frac{T ^{\prime}}{T} - \frac{\rho_0 ^{\prime}}{\rho_0}  \\
  &= \frac{T ^{\prime}}{T} + \frac{A-1}{B} \frac{\rho_0 ^{\prime}}{\rho_0 }  \\
  \frac{T ^{\prime}}{T} &= \frac{b}{B} \frac{\rho_0 ^{\prime}}{\rho_0}
  = (\Gamma - 1) \frac{\rho_0  ^{\prime}}{\rho_0  }
\end{align}
\end{subequations}
%
where we define the \emph{local adiabatic exponent} \(\Gamma = 1+b/B\).

When we insert the relations into equation \eqref{eq:accretion-euler} we get:
%
\begin{subequations}
\begin{align}
  0 &= \frac{y ^{\prime}}{y} + a \frac{\rho_0 ^{\prime}}{\rho_0} + b \frac{T ^{\prime}}{T}  \\
  &= \frac{y ^{\prime}}{y} + a \frac{\rho_0 ^{\prime}}{\rho_0} + \frac{b^2}{B} \frac{\rho_0 ^{\prime}}{\rho_0}   \\
  &= \frac{y ^{\prime}}{y} + v_s^2 \qty(-2- \frac{(yv) ^{\prime}}{yv})    \\
  &= \qty(\gamma^2 v^2 \frac{v ^{\prime}}{v} + \frac{M \gamma^2}{y^2 r} ) + -v_s^2 \qty(2 + \frac{(yv) ^{\prime}}{yv})    \\
  &\overset{?}{=}  (v^2 - v_s^2) \frac{(yv) ^{\prime}}{yv} - 2 v_s^2 + \frac{M}{y^2r} 
\end{align}
\end{subequations}

\begin{greenbox}
  To add: commentary on the equation system, its boundary conditions \(\rho_\infty\) and \(T_\infty\), and the fact that to make the system regular at \(v = v_s\) the problem becomes uniquely determined.
\end{greenbox}

\end{document}
